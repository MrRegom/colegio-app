{% extends 'partials/base.html' %}
{% load static %}

{% block title %}Detalle de Equipo Médico{% endblock title %}

{% block extra_css %}
<!-- Sweet Alert css-->
<link href="{% static 'libs/sweetalert2/sweetalert2.min.css' %}" rel="stylesheet" type="text/css" />
{% endblock extra_css %}

{% block main_title %}
<div class="page-title-box">
    <div class="row align-items-center">
        <div class="col-md-8">
            {% block pagetitle %}
                {% include "partials/page-title.html" with pagetitle="Equipos Médicos" title="Detalle de Equipo" %}
            {% endblock pagetitle %}
        </div><!--end col-->
        <div class="col-md-4">
            <div class="d-flex gap-2 justify-content-end">
                <a href="{% url 'medicals_systems:equipo_medico_list' %}" class="btn btn-primary">
                    <i class="ri-arrow-left-line align-bottom"></i> Volver a la Lista
                </a>
                <div class="dropdown">
                    <button class="btn btn-soft-secondary btn-icon" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="ri-more-2-fill"></i>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="{% url 'medicals_systems:equipo_medico_edit' equipo_medico.id %}"><i class="ri-pencil-line align-bottom me-2 text-muted"></i> Editar</a></li>
                        <li><a class="dropdown-item" href="{% url 'medicals_systems:equipo_medico_delete' equipo_medico.id %}"><i class="ri-delete-bin-line align-bottom me-2 text-muted"></i> Eliminar</a></li>
                    </ul>
                </div>
            </div>
        </div><!--end col-->
    </div><!--end row-->
</div>
{% endblock main_title %}

{% block content %}
<div class="row">
    <div class="col-lg-12">
        <div class="card">
            <div class="card-header">
                <div class="d-flex align-items-center">
                    <h4 class="card-title mb-0 flex-grow-1">
                        {{ equipo_medico.nombre }}
                        {% if equipo_medico.estado_actual %}
                        <span class="badge bg-{% if equipo_medico.estado_actual.nombre_estado == 'Operativo' %}success{% elif equipo_medico.estado_actual.nombre_estado == 'Mantenimiento' %}warning{% elif equipo_medico.estado_actual.nombre_estado == 'Fuera de servicio' %}danger{% else %}info{% endif %} ms-2">
                            {{ equipo_medico.estado_actual.nombre_estado }}
                        </span>
                        {% endif %}
                    </h4>
                </div>
            </div>
            <div class="card-body">
                <!-- Información básica -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h5 class="text-primary mb-3">Información Básica</h5>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="ri-barcode-line text-primary fs-18 me-1"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">ID de Equipo</h6>
                                <p class="text-muted mb-0">{{ equipo_medico.id_equipo }}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="ri-building-line text-primary fs-18 me-1"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Marca</h6>
                                <p class="text-muted mb-0">{{ equipo_medico.marca }}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="ri-tools-line text-primary fs-18 me-1"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Modelo</h6>
                                <p class="text-muted mb-0">{{ equipo_medico.modelo }}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="ri-fingerprint-line text-primary fs-18 me-1"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Número de Serie</h6>
                                <p class="text-muted mb-0">{{ equipo_medico.numero_serie }}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="ri-calendar-line text-primary fs-18 me-1"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Año de Fabricación</h6>
                                <p class="text-muted mb-0">{{ equipo_medico.anio_fabricacion }}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="ri-heart-pulse-line text-primary fs-18 me-1"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Uso Clínico</h6>
                                <p class="text-muted mb-0">{{ equipo_medico.uso_clinico }}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="ri-map-pin-line text-primary fs-18 me-1"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Ubicación</h6>
                                <p class="text-muted mb-0">{{ equipo_medico.ubicacion }}</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Información de red y comunicaciones -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h5 class="text-primary mb-3">Red y Comunicaciones</h5>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="ri-wifi-line text-primary fs-18 me-1"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Tipo de Red</h6>
                                <p class="text-muted mb-0">{{ equipo_medico.tipo_red.nombre_red|default:"No asignado" }}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="ri-global-line text-primary fs-18 me-1"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Dirección IP</h6>
                                <p class="text-muted mb-0">{{ equipo_medico.direccion_ip }}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="ri-plug-line text-primary fs-18 me-1"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Puerto de Comunicación</h6>
                                <p class="text-muted mb-0">{{ equipo_medico.puerto_comunicacion }}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="ri-share-line text-primary fs-18 me-1"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Protocolo de Comunicación</h6>
                                <p class="text-muted mb-0">{{ equipo_medico.protocolo_comunicacion|default:"No especificado" }}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="ri-link-m text-primary fs-18 me-1"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Interoperabilidad</h6>
                                <p class="text-muted mb-0">{{ equipo_medico.interoperabilidad.nombre_unidad|default:"No asignada" }}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="ri-hospital-line text-primary fs-18 me-1"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Integración HIS</h6>
                                <p class="text-muted mb-0">{% if equipo_medico.integracion_his %}Sí{% else %}No{% endif %}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="ri-code-line text-primary fs-18 me-1"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Versión de Firmware</h6>
                                <p class="text-muted mb-0">{{ equipo_medico.firmware_version|default:"No especificado" }}</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Información de mantenimiento -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h5 class="text-primary mb-3">Mantenimiento</h5>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="ri-calendar-check-line text-primary fs-18 me-1"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Última Mantención</h6>
                                <p class="text-muted mb-0">{{ equipo_medico.fecha_ultima_mantencion|date:"d/m/Y" }}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="ri-calendar-todo-line text-primary fs-18 me-1"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Próxima Mantención</h6>
                                <p class="text-muted mb-0">{{ equipo_medico.fecha_proxima_mantencion|date:"d/m/Y" }}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="ri-user-settings-line text-primary fs-18 me-1"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Técnico Responsable</h6>
                                <p class="text-muted mb-0">{{ equipo_medico.tecnico_responsable|default:"No asignado" }}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="ri-service-line text-primary fs-18 me-1"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Proveedor Mantenimiento</h6>
                                <p class="text-muted mb-0">{{ equipo_medico.proveedor_mantenimiento|default:"No asignado" }}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="ri-phone-line text-primary fs-18 me-1"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Teléfono Soporte</h6>
                                <p class="text-muted mb-0">{{ equipo_medico.telefono_soporte|default:"No especificado" }}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="ri-money-dollar-circle-line text-primary fs-18 me-1"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Costo Promedio Mantenimiento</h6>
                                <p class="text-muted mb-0">$ {{ equipo_medico.costo_promedio_mantenimiento }}</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Información energética -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h5 class="text-primary mb-3">Energía</h5>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="ri-plug-2-line text-primary fs-18 me-1"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Fuente de Alimentación</h6>
                                <p class="text-muted mb-0">{{ equipo_medico.fuente_alimentacion.nombre_energia|default:"No asignada" }}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="ri-battery-charge-line text-primary fs-18 me-1"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Consumo de Energía</h6>
                                <p class="text-muted mb-0">{{ equipo_medico.consumo_energia }} W</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="ri-device-line text-primary fs-18 me-1"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">UPS Asignado</h6>
                                <p class="text-muted mb-0">{{ equipo_medico.ups_asignado|default:"No asignado" }}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="d-flex mb-3">
                            <div class="flex-shrink-0">
                                <i class="ri-temp-cold-line text-primary fs-18 me-1"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">Condiciones Ambientales</h6>
                                <p class="text-muted mb-0">{{ equipo_medico.condiciones_ambientales|default:"No especificadas" }}</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Registro de fallas -->
                <div class="row">
                    <div class="col-12">
                        <h5 class="text-primary mb-3">Registro de Fallas</h5>
                        <div class="card border shadow-none">
                            <div class="card-body">
                                <p class="text-muted mb-0">{{ equipo_medico.registro_fallas|default:"No hay registro de fallas"|linebreaksbr }}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock content %}

{% block extra_js %}
<!-- Sweet Alert js -->
<script src="{% static 'libs/sweetalert2/sweetalert2.min.js' %}"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        // Mostrar mensajes de error/éxito si los hay
        {% if messages %}
            {% for message in messages %}
                Swal.fire({
                    title: '{{ message.tags|title }}',
                    text: '{{ message }}',
                    icon: '{% if message.tags == "error" %}error{% else %}success{% endif %}',
                    confirmButtonText: 'Aceptar'
                });
            {% endfor %}
        {% endif %}
    });
</script>
{% endblock extra_js %} 